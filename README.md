# SegMeshGS: A Segmentation & Meshing Pipeline for 3D Gaussian Splatting

[![Unity Version](https://img.shields.io/badge/Unity-2022.3.21f1-blue.svg)](https://unity.com/)
[![Python](https://img.shields.io/badge/Python-3.9%2B-blue.svg)](https://www.python.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**SegMeshGS** is an end-to-end automated pipeline that reconstructs a 3D scene from a video using 3D Gaussian Splatting (3DGS), allows for intuitive object segmentation via a simple click, and extracts the selected object into a high-quality 3D mesh.

The entire workflow is integrated into the Unity editor through the **UnitySegMeshGS** module, providing a seamless and user-friendly experience for content creators, artists, and designers to bring real-world objects into their projects without leaving their primary work environment.

---

## üöÄ Key Features

* **Fully Automated Pipeline**: Streamlines the entire process from video input to final 3D mesh and texture generation.
* **Intuitive Click-Based Segmentation**: Leverages the power of **SAGA** to precisely segment any object within a 3DGS scene with a single click.
* **High-Quality Mesh Extraction**: Utilizes **SuGaR** to convert segmented Gaussians into a clean, well-structured 3D mesh with detailed textures.
* **Seamless Unity Integration**: The **UnitySegMeshGS** module allows users to execute the entire Python-based pipeline asynchronously from the Unity inspector, preventing editor freeze-ups.
* **Modular Workflow**: Each stage of the pipeline (Vanilla Scene, Segmented Scene, Mesh) produces independent, usable assets, giving creators flexibility.

---

## üõ†Ô∏è Pipeline Workflow

The SegMeshGS pipeline is composed of four main stages, designed to run sequentially with minimal user intervention.

<details>
  <summary><b>Click to Expand for Detailed Workflow</b></summary>

### **1. Preprocessing (Frame Extraction & SfM)**
-   **Input**: A single `.mp4` video file.
-   **Tools**: `FFmpeg`, `COLMAP`
-   **Process**:
    1.  **Keyframe Extraction**: `FFmpeg` is used to extract high-quality, non-blurry frames from the source video.
    2.  **Structure-from-Motion (SfM)**: `COLMAP` processes the extracted images to calculate camera poses and generate a sparse point cloud, which serves as the initial geometry for the 3DGS scene.

### **2. Vanilla 3DGS Scene Generation**
-   **Input**: COLMAP output folder.
-   **Process**: The standard 3DGS training algorithm is used to create a photorealistic 3D scene from the COLMAP data. The resulting scene (`.ply` file) has high visual fidelity but lacks any semantic information.

### **3. 3DGS Segmentation (Powered by SAGA)**
-   **Input**: Vanilla 3DGS scene, source images.
-   **Core Technology**: **SAGA (Segment Any 3D Gaussians)**
-   **Process**:
    1.  **Affinity Feature Training**: SAGA attaches a learnable feature vector (Affinity Feature) to each 3D Gaussian. Using 2D masks generated by the Segment Anything Model (SAM), it trains the scene so that Gaussians belonging to the same object have similar features.
    2.  **User-guided Extraction**: The trained scene is opened in the SAGA viewer. The user clicks on any point of the desired object.
    3.  **Export Segmented Object**: The viewer highlights all Gaussians with similar features. This selection is then exported as a new `.ply` file.
    > **‚ö†Ô∏è Important**: The user must name the exported file with a meaningful English word (e.g., `chair.ply`, `sculpture.ply`). This name is used as a text prompt in the next stage.

### **4. 3DGS Meshing (Powered by SuGaR)**
-   **Input**: Segmented object `.ply` file, source images, and the object name from the filename.
-   **Core Technology**: **SuGaR (Surface-Aligned Gaussian Splatting)**
-   **Process**:
    1.  **Input Image Masking**: Using the filename as a text prompt, the **CLIP** model identifies and masks the corresponding object in the 2D source images. This ensures the meshing algorithm focuses only on the target object.
    2.  **Surface Alignment**: SuGaR runs an additional optimization process that regularizes the segmented Gaussians, forcing them to become flat and align tightly with the object's actual surface.
    3.  **Mesh & Texture Generation**: The aligned Gaussians form a dense, oriented point cloud. The **Poisson Surface Reconstruction** algorithm is then applied to this point cloud to generate the final, high-quality 3D mesh (`.obj`) and bake the Gaussian colors into a UV texture map.

</details>

---

## üéÆ Unity Integration: `UnitySegMeshGS`

To make this powerful pipeline accessible to artists and developers, we developed **UnitySegMeshGS**, an editor extension that brings the entire workflow inside Unity.

* **Integrated 3DGS Viewer**: Built upon the `UnityGaussianSplatting` open-source project, our viewer renders `.ply` files directly in the Unity scene. It fully supports Unity's depth buffer, allowing 3DGS assets to correctly intersect and occlude standard mesh-based GameObjects.
* **GUI-Driven Pipeline**: No more command lines. The entire SegMeshGS pipeline can be executed through intuitive components and buttons within the Unity Inspector.
* **Asynchronous Execution**: All heavy computational tasks are offloaded to a background Python process running in WSL2. This keeps the Unity editor responsive, allowing you to continue working while the pipeline runs.
* **Automatic Asset Importer**: A "Show 3DGS" utility provides a one-click solution to import any `.ply` file, automatically converting it into a renderable Unity asset and adding it to the current scene.

---

## üìö References & Credits

This project stands on the shoulders of giants. We are immensely grateful to the researchers and developers behind these incredible open-source projects:

-   **3D Gaussian Splatting**: [3D Gaussian Splatting for Real-Time Radiance Field Rendering](https://repo-sam.inria.fr/fungraph/3d-gaussian-splatting/)
-   **SAGA**: [Segment Any 3D Gaussians](https://github.com/Jumpat/SegAnyGAussians)
-   **SuGaR**: [Surface-Aligned Gaussian Splatting for Efficient 3D Mesh Reconstruction](https://github.com/Anttwo/SuGaR)
-   **Unity Viewer**: [UnityGaussianSplatting by @aras-p](https://github.com/aras-p/UnityGaussianSplatting)
